<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>DualPay – Ресто</title>


<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>


<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@600&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">


<style>
body {
  font-family: 'Montserrat', sans-serif;
}
h1, h2 {
  font-family: 'Comfortaa', cursive;
}


/* Floating background symbols */
.bg-symbol {
  position: absolute;
  opacity: 0.04;
  font-size: 3rem;
  animation: float 18s ease-in-out infinite;
}


@keyframes float {
  0% { transform: translate(0,0) rotate(0deg) scale(1); }
  50% { transform: translate(20px,-30px) rotate(8deg) scale(1.1); }
  100% { transform: translate(0,0) rotate(0deg) scale(1); }
}
</style>
</head>


<body class="min-h-screen flex items-center justify-center bg-pink-50 relative overflow-hidden">


<!-- Background symbols -->
<div id="bg"></div>


<!-- App Card -->
<div class="relative z-10 w-full max-w-sm mx-3 p-6 rounded-3xl bg-white/70 backdrop-blur-xl shadow-2xl">


  <!-- Logo -->
  <div class="flex justify-center mb-4">
    <div class="px-4 py-2 rounded-xl bg-emerald-600 text-white text-lg shadow-lg">
      € ⇄ лв
    </div>
  </div>


  <h1 class="text-center text-xl mb-6">DualPay – Калкулатор за ресто</h1>


  <!-- Amount -->
  <label class="text-sm">Сума за плащане</label>
  <div class="flex gap-2 mb-4">
    <input id="price" type="number" class="flex-1 p-3 rounded-xl bg-pink-100 outline-none">
    <select id="priceCurrency" class="p-3 rounded-xl bg-emerald-600 text-white">
      <option value="BGN">лв</option>
      <option value="EUR">€</option>
    </select>
  </div>


  <!-- Paid -->
  <label class="text-sm">Платено</label>
  <input id="paidBGN" type="number" placeholder="Платено в лв" class="w-full p-3 rounded-xl mb-2 bg-white">
  <input id="paidEUR" type="number" placeholder="Платено в €" class="w-full p-3 rounded-xl bg-white">


  <!-- Error -->
  <div id="error" class="hidden mt-3 p-3 rounded-xl bg-red-100 text-red-700 text-sm">
    Недостатъчна сума
  </div>


  <!-- Result -->
  <div id="resultBox" class="hidden mt-4 p-4 rounded-xl bg-emerald-50 transition-all">
    <div class="flex justify-between mb-2">
      <button onclick="setResultCurrency('BGN')" class="px-3 py-1 rounded-lg bg-emerald-600 text-white">лв</button>
      <button onclick="setResultCurrency('EUR')" class="px-3 py-1 rounded-lg bg-emerald-600 text-white">€</button>
    </div>
    <div class="text-center">
      <div id="changeMain" class="text-2xl font-semibold"></div>
      <div id="changeAlt" class="text-sm opacity-70"></div>
    </div>
  </div>


  <!-- Footer -->
  <div class="mt-6 text-center text-xs opacity-70">
    Курс: 1 EUR = 1.95583 BGN<br>
    © Николета Бодурова
  </div>
</div>


<script>
const RATE = 1.95583;
let resultCurrency = 'BGN';


const price = document.getElementById('price');
const priceCurrency = document.getElementById('priceCurrency');
const paidBGN = document.getElementById('paidBGN');
const paidEUR = document.getElementById('paidEUR');
const errorBox = document.getElementById('error');
const resultBox = document.getElementById('resultBox');
const changeMain = document.getElementById('changeMain');
const changeAlt = document.getElementById('changeAlt');


function calc() {
  const priceVal = parseFloat(price.value || 0);
  let priceBGN = priceCurrency.value === 'EUR' ? priceVal * RATE : priceVal;


  const totalPaidBGN =
    (parseFloat(paidBGN.value || 0)) +
    (parseFloat(paidEUR.value || 0) * RATE);


  if (!priceVal) return;


  if (totalPaidBGN < priceBGN) {
    errorBox.classList.remove('hidden');
    resultBox.classList.add('hidden');
    return;
  }


  errorBox.classList.add('hidden');
  resultBox.classList.remove('hidden');


  const changeBGN = totalPaidBGN - priceBGN;
  const changeEUR = changeBGN / RATE;


  if (resultCurrency === 'BGN') {
    changeMain.textContent = `${changeBGN.toFixed(2)} лв`;
    changeAlt.textContent = `≈ ${changeEUR.toFixed(2)} €`;
  } else {
    changeMain.textContent = `${changeEUR.toFixed(2)} €`;
    changeAlt.textContent = `≈ ${changeBGN.toFixed(2)} лв`;
  }
}


function setResultCurrency(cur) {
  resultCurrency = cur;
  calc();
}


[price, priceCurrency, paidBGN, paidEUR].forEach(el =>
  el.addEventListener('input', calc)
);


/* Background symbols */
const bg = document.getElementById('bg');
for (let i = 0; i < 30; i++) {
  const s = document.createElement('div');
  s.className = 'bg-symbol';
  s.textContent = i % 2 === 0 ? '€' : 'лв';
  s.style.left = Math.random() * 100 + '%';
  s.style.top = Math.random() * 100 + '%';
  s.style.animationDelay = Math.random() * 10 + 's';
  bg.appendChild(s);
}


/* Canvas icon + Manifest + Service Worker */
const canvas = document.createElement('canvas');
canvas.width = canvas.height = 512;
const ctx = canvas.getContext('2d');
ctx.fillStyle = '#059669';
ctx.fillRect(0,0,512,512);
ctx.fillStyle = '#fff';
ctx.font = 'bold 120px Comfortaa';
ctx.textAlign = 'center';
ctx.textBaseline = 'middle';
ctx.fillText('€ ⇄ лв',256,256);


const iconURL = canvas.toDataURL();


const manifest = {
  name: "DualPay",
  short_name: "DualPay",
  start_url: ".",
  display: "standalone",
  background_color: "#fdf2f8",
  theme_color: "#059669",
  icons: [{ src: iconURL, sizes: "512x512", type: "image/png" }]
};


const manifestBlob = new Blob([JSON.stringify(manifest)], {type:'application/json'});
const manifestURL = URL.createObjectURL(manifestBlob);
const link = document.createElement('link');
link.rel = 'manifest';
link.href = manifestURL;
document.head.appendChild(link);


const swCode = `
self.addEventListener('install', e => self.skipWaiting());
self.addEventListener('fetch', e => {});
`;
const swBlob = new Blob([swCode], {type:'text/javascript'});
navigator.serviceWorker.register(URL.createObjectURL(swBlob));
</script>
</body>
</html>